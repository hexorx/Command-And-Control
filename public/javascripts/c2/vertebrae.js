eval(function(h,b,j,f,g,i){g=function(a){return(a<b?"":g(parseInt(a/b)))+((a=a%b)>35?String.fromCharCode(a+29):a.toString(36))};if(!"".replace(/^/,String)){while(j--){i[g(j)]=f[j]||g(j)}f=[function(a){return i[a]}];g=function(){return"\\w+"};j=1}while(j--){if(f[j]){h=h.replace(new RegExp("\\b"+g(j)+"\\b","g"),f[j])}}return h}('8.$2m=1.2n;8.Q=u(x){e(x<0||x>9?"":"0")+x};8.1g=B R(\'2o\',\'2p\',\'2l\',\'2k\',\'1z\',\'2g\',\'2h\',\'2i\',\'2j\',\'2q\',\'2r\',\'2y\');8.14=B R(\'2z\',\'2A\',\'2x\',\'2w\',\'1z\',\'2s\',\'2t\',\'2u\',\'2v\',\'2f\',\'2b\',\'1R\');8.1d=B R(\'1W\',\'1Z\',\'1Y\',\'1V\',\'1U\',\'1S\',\'1T\');8.1f=B R(\'1X\',\'2e\',\'20\',\'2c\',\'2d\',\'2a\',\'27\');8.1s=1L;3(!8.C.1c){8.C.1c=u(){b S=7.1y();e(S<16?S+16:S)}}8.1q=u(r,t){3(1e(t)=="1a"||t==f||t==""){b 1D=B R(\'y-M-d\',\'G d, y\',\'G d,y\',\'y-G-d\',\'d-G-y\',\'G d\',\'G-d\',\'d-G\');b 1v=B R(\'M/d/y\',\'M-d-y\',\'M.d.y\',\'M/d\',\'M-d\');b 1t=B R(\'d/M/y\',\'d-M-y\',\'d.M.y\',\'d/M\',\'d-M\');b 1u=B R(1D,8.1s?1v:1t,8.1s?1t:1v);Z(b i=0;i<1u.g;i++){b l=1u[i];Z(b j=0;j<l.g;j++){b d=8.1q(r,l[j]);3(d!=f){e d}}}e f};7.1I=u(r){Z(b i=0;i<r.g;i++){3("26".2C(r.U(i))==-1){e 13}}e 1L};7.O=u(1E,i,1i,1C){Z(b x=1C;x>=1i;x--){b 5=1E.T(i,i+x);3(5.g<1i){e f}3(7.1I(5)){e 5}}e f};r=r+"";t=t+"";b o=0;b D=0;b c="";b 5="";b 2T="";b x,y;b A=B 8().1c();b v=1;b I=1;b p=0;b J=0;b L=0;b 10="";W(D<t.g){c=t.U(D);5="";W((t.U(D)==c)&&(D<t.g)){5+=t.U(D++)}3(5=="19"||5=="S"||5=="y"){3(5=="19"){x=4;y=4}3(5=="S"){x=2;y=2}3(5=="y"){x=2;y=4}A=7.O(r,o,x,y);3(A==f){e f}o+=A.g;3(A.g==2){3(A>2V){A=16+(A-0)}q{A=2R+(A-0)}}}q 3(5=="G"||5=="1P"){v=0;b Y=(5=="G"?(8.1g.2O(8.14)):8.14);Z(b i=0;i<Y.g;i++){b 1h=Y[i];3(r.T(o,o+1h.g).V()==1h.V()){v=(i%12)+1;o+=1h.g;1A}}3((v<1)||(v>12)){e f}}q 3(5=="1r"||5=="E"){b Y=(5=="1r"?8.1d:8.1f);Z(b i=0;i<Y.g;i++){b 18=Y[i];3(r.T(o,o+18.g).V()==18.V()){o+=18.g;1A}}}q 3(5=="1o"||5=="M"){v=7.O(r,o,5.g,2);3(v==f||(v<1)||(v>12)){e f}o+=v.g}q 3(5=="1m"||5=="d"){I=7.O(r,o,5.g,2);3(I==f||(I<1)||(I>2E)){e f}o+=I.g}q 3(5=="p"||5=="h"){p=7.O(r,o,5.g,2);3(p==f||(p<1)||(p>12)){e f}o+=p.g}q 3(5=="1k"||5=="H"){p=7.O(r,o,5.g,2);3(p==f||(p<0)||(p>23)){e f}o+=p.g}q 3(5=="1l"||5=="K"){p=7.O(r,o,5.g,2);3(p==f||(p<0)||(p>11)){e f}o+=p.g;p++}q 3(5=="1j"||5=="k"){p=7.O(r,o,5.g,2);3(p==f||(p<1)||(p>24)){e f}o+=p.g;p--}q 3(5=="J"||5=="m"){J=7.O(r,o,5.g,2);3(J==f||(J<0)||(J>1K)){e f}o+=J.g}q 3(5=="L"||5=="s"){L=7.O(r,o,5.g,2);3(L==f||(L<0)||(L>1K)){e f}o+=L.g}q 3(5=="a"){3(r.T(o,o+2).V()=="2J"){10="1w"}q 3(r.T(o,o+2).V()=="2N"){10="1x"}q{e f}o+=2}q{3(r.T(o,o+5.g)!=5){e f}q{o+=5.g}}}3(o!=r.g){e f}3(v==2){3(((A%4==0)&&(A%2M!=0))||(A%2L==0)){3(I>29){e f}}q{3(I>28){e f}}}3((v==4)||(v==6)||(v==9)||(v==11)){3(I>2K){e f}}3(p<12&&10=="1x"){p=p-0+12}q 3(p>11&&10=="1w"){p-=12}e B 8(A,v-1,I,p,J,L)};8.2I=u(r,t){e(8.1q(r,t)!=f)};8.C.2D=u(F){3(F==f){e 13}e(7.P()<F.P())};8.C.2F=u(F){3(F==f){e 13}e(7.P()>F.P())};8.C.2G=u(F){3(F==f){e 13}e(7.P()==F.P())};8.C.2W=u(F){3(F==f){e 13}b 1J=B 8(7.P()).1p();b 1F=B 8(F.P()).1p();e(1J.P()==1F.P())};8.C.t=u(t){t=t+"";b X="";b D=0;b c="";b 5="";b y=7.1y()+"";b M=7.1b()+1;b d=7.1Q();b E=7.15();b H=7.1N();b m=7.1G();b s=7.1H();b 19,S,G,1o,1m,p,h,J,L,10,1k,H,1l,K,1j,k;b n=B 2B();3(y.g<4){y=""+(+y+16)}n["y"]=""+y;n["19"]=y;n["S"]=y.T(2,4);n["M"]=M;n["1o"]=8.Q(M);n["G"]=8.1g[M-1];n["1P"]=8.14[M-1];n["d"]=d;n["1m"]=8.Q(d);n["E"]=8.1f[E];n["1r"]=8.1d[E];n["H"]=H;n["1k"]=8.Q(H);3(H==0){n["h"]=12}q 3(H>12){n["h"]=H-12}q{n["h"]=H}n["p"]=8.Q(n["h"]);n["K"]=n["h"]-1;n["k"]=n["H"]+1;n["1l"]=8.Q(n["K"]);n["1j"]=8.Q(n["k"]);3(H>11){n["a"]="1x"}q{n["a"]="1w"}n["m"]=m;n["J"]=8.Q(m);n["s"]=s;n["L"]=8.Q(s);W(D<t.g){c=t.U(D);5="";W((t.U(D)==c)&&(D<t.g)){5+=t.U(D++)}3(1e(n[5])!="1a"){X=X+n[5]}q{X=X+5}}e X};8.C.2P=u(){e 8.1d[7.15()]};8.C.2H=u(){e 8.1f[7.15()]};8.C.2U=u(){e 8.1g[7.1b()]};8.C.2Q=u(){e 8.14[7.1b()]};8.C.1p=u(){7.1O(0);7.1B(0);7.1M(0);7.2S(0);e 7};8.C.1n=u(N,z){3(1e(N)=="1a"||N==f||1e(z)=="1a"||z==f){e 7}z=+z;3(N==\'y\'){7.25(7.1c()+z)}q 3(N==\'M\'){7.22(7.1b()+z)}q 3(N==\'d\'){7.21(7.1Q()+z)}q 3(N==\'w\'){b 17=(z>0)?1:-1;W(z!=0){7.1n(\'d\',17);W(7.15()==0||7.15()==6){7.1n(\'d\',17)}z-=17}}q 3(N==\'h\'){7.1O(7.1N()+z)}q 3(N==\'m\'){7.1B(7.1G()+z)}q 3(N==\'s\'){7.1M(7.1H()+z)}e 7};',62,183,"|||if||token||this|Date|||var|||return|null|length|||||||value|i_val|hh|else|val||format|function|month||||number|year|new|prototype|i_format||date2|MMM||date|mm||ss||interval|getInt|getTime|LZ|Array|yy|substring|charAt|toLowerCase|while|result|names|for|ampm|||false|monthAbbreviations|getDay|1900|step|day_name|yyyy|undefined|getMonth|getFullYear|dayNames|typeof|dayAbbreviations|monthNames|month_name|minlength|kk|HH|KK|dd|add|MM|clearTime|parseString|EE|preferAmericanFormat|dateFirst|checkList|monthFirst|AM|PM|getYear|May|break|setMinutes|maxlength|generalFormats|str|d2|getMinutes|getSeconds|isInteger|d1|59|true|setSeconds|getHours|setHours|NNN|getDate|Dec|Friday|Saturday|Thursday|Wednesday|Sunday|Sun|Tuesday|Monday|Tue|setDate|setMonth|||setFullYear|1234567890|Sat|||Fri|Nov|Wed|Thu|Mon|Oct|June|July|August|September|April|March|VERSION|02|January|February|October|November|Jun|Jul|Aug|Sep|Apr|Mar|December|Jan|Feb|Object|indexOf|isBefore|31|isAfter|equals|getDayAbbreviation|isValid|am|30|400|100|pm|concat|getDayName|getMonthAbbreviation|2000|setMilliseconds|token2|getMonthName|70|equalsIgnoreTime".split("|"),0,{}));if(!this.JSON){this.JSON={}}(function(){function k(a){return a<10?"0"+a:a}if(typeof Date.prototype.toJSON!=="function"){Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+k(this.getUTCMonth()+1)+"-"+k(this.getUTCDate())+"T"+k(this.getUTCHours())+":"+k(this.getUTCMinutes())+":"+k(this.getUTCSeconds())+"Z":null};String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()}}var n=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,o=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,f,l,q={"\u0008":"\\b","\t":"\\t","\n":"\\n","\u000c":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},i;function p(a){o.lastIndex=0;return o.test(a)?'"'+a.replace(o,function(c){var d=q[c];return typeof d==="string"?d:"\\u"+("0000"+c.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function m(a,c){var d,g,j=f,e,b=c[a];if(b&&typeof b==="object"&&typeof b.toJSON==="function"){b=b.toJSON(a)}if(typeof i==="function"){b=i.call(c,a,b)}switch(typeof b){case"string":return p(b);case"number":return isFinite(b)?String(b):"null";case"boolean":case"null":return String(b);case"object":if(!b){return"null"}f+=l;e=[];if(Object.prototype.toString.apply(b)==="[object Array]"){g=b.length;for(a=0;a<g;a+=1){e[a]=m(a,b)||"null"}c=e.length===0?"[]":f?"[\n"+f+e.join(",\n"+f)+"\n"+j+"]":"["+e.join(",")+"]";f=j;return c}if(i&&typeof i==="object"){g=i.length;for(a=0;a<g;a+=1){d=i[a];if(typeof d==="string"){if(c=m(d,b)){e.push(p(d)+(f?": ":":")+c)}}}}else{for(d in b){if(Object.hasOwnProperty.call(b,d)){if(c=m(d,b)){e.push(p(d)+(f?": ":":")+c)}}}}c=e.length===0?"{}":f?"{\n"+f+e.join(",\n"+f)+"\n"+j+"}":"{"+e.join(",")+"}";f=j;return c}}if(typeof JSON.stringify!=="function"){JSON.stringify=function(a,c,d){var g;l=f="";if(typeof d==="number"){for(g=0;g<d;g+=1){l+=" "}}else{if(typeof d==="string"){l=d}}if((i=c)&&typeof c!=="function"&&(typeof c!=="object"||typeof c.length!=="number")){throw new Error("JSON.stringify")}return m("",{"":a})}}if(typeof JSON.parse!=="function"){JSON.parse=function(a,c){function d(g,j){var e,b,h=g[j];if(h&&typeof h==="object"){for(e in h){if(Object.hasOwnProperty.call(h,e)){b=d(h,e);if(b!==undefined){h[e]=b}else{delete h[e]}}}}return c.call(g,j,h)}a=String(a);n.lastIndex=0;if(n.test(a)){a=a.replace(n,function(g){return"\\u"+("0000"+g.charCodeAt(0).toString(16)).slice(-4)})}if(/^[\],:{}\s]*$/.test(a.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){a=eval("("+a+")");return typeof c==="function"?d({"":a},""):a}throw new SyntaxError("JSON.parse")}}})();(function(){var y;y=typeof exports!=="undefined"?exports:this.Backbone={};y.VERSION="0.3.3";var x=this._;if(!x&&typeof require!=="undefined"){x=require("underscore")._}var w=this.jQuery||this.Zepto;y.emulateHTTP=false;y.emulateJSON=false;y.Events={bind:function(f,e){this._callbacks||(this._callbacks={});(this._callbacks[f]||(this._callbacks[f]=[])).push(e);return this},unbind:function(f,e){var k;if(f){if(k=this._callbacks){if(e){k=k[f];if(!k){return this}for(var j=0,h=k.length;j<h;j++){if(e===k[j]){k.splice(j,1);break}}}else{k[f]=[]}}}else{this._callbacks={}}return this},trigger:function(f){var e,k,j,h;if(!(k=this._callbacks)){return this}if(e=k[f]){j=0;for(h=e.length;j<h;j++){e[j].apply(this,Array.prototype.slice.call(arguments,1))}}if(e=k.all){j=0;for(h=e.length;j<h;j++){e[j].apply(this,arguments)}}return this}};y.Model=function(f,e){f||(f={});if(this.defaults){f=x.extend({},this.defaults,f)}this.attributes={};this._escapedAttributes={};this.cid=x.uniqueId("c");this.set(f,{silent:true});this._previousAttributes=x.clone(this.attributes);if(e&&e.collection){this.collection=e.collection}this.initialize(f,e)};x.extend(y.Model.prototype,y.Events,{_previousAttributes:null,_changed:false,initialize:function(){},toJSON:function(){return x.clone(this.attributes)},get:function(e){return this.attributes[e]},escape:function(f){var e;if(e=this._escapedAttributes[f]){return e}e=this.attributes[f];return this._escapedAttributes[f]=(e==null?"":e).replace(/&(?!\w+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},set:function(f,e){e||(e={});if(!f){return this}if(f.attributes){f=f.attributes}var l=this.attributes,k=this._escapedAttributes;if(!e.silent&&this.validate&&!this._performValidation(f,e)){return false}if("id" in f){this.id=f.id}for(var j in f){var h=f[j];if(!x.isEqual(l[j],h)){l[j]=h;delete k[j];if(!e.silent){this._changed=true;this.trigger("change:"+j,this,h,e)}}}!e.silent&&this._changed&&this.change(e);return this},unset:function(f,e){e||(e={});var h={};h[f]=void 0;if(!e.silent&&this.validate&&!this._performValidation(h,e)){return false}delete this.attributes[f];delete this._escapedAttributes[f];if(!e.silent){this._changed=true;this.trigger("change:"+f,this,void 0,e);this.change(e)}return this},clear:function(f){f||(f={});var e=this.attributes,h={};for(attr in e){h[attr]=void 0}if(!f.silent&&this.validate&&!this._performValidation(h,f)){return false}this.attributes={};this._escapedAttributes={};if(!f.silent){this._changed=true;for(attr in e){this.trigger("change:"+attr,this,void 0,f)}this.change(f)}return this},fetch:function(f){f||(f={});var e=this,h=v(f.error,e,f);(this.sync||y.sync)("read",this,function(j){if(!e.set(e.parse(j),f)){return false}f.success&&f.success(e,j)},h);return this},save:function(f,e){e||(e={});if(f&&!this.set(f,e)){return false}var k=this,j=v(e.error,k,e),h=this.isNew()?"create":"update";(this.sync||y.sync)(h,this,function(l){if(!k.set(k.parse(l),e)){return false}e.success&&e.success(k,l)},j);return this},destroy:function(f){f||(f={});var e=this,h=v(f.error,e,f);(this.sync||y.sync)("delete",this,function(j){e.collection&&e.collection.remove(e);f.success&&f.success(e,j)},h);return this},url:function(){var e=u(this.collection);if(this.isNew()){return e}return e+(e.charAt(e.length-1)=="/"?"":"/")+this.id},parse:function(e){return e},clone:function(){return new this.constructor(this)},isNew:function(){return !this.id},change:function(e){this.trigger("change",this,e);this._previousAttributes=x.clone(this.attributes);this._changed=false},hasChanged:function(e){if(e){return this._previousAttributes[e]!=this.attributes[e]}return this._changed},changedAttributes:function(f){f||(f=this.attributes);var e=this._previousAttributes,j=false,h;for(h in f){if(!x.isEqual(e[h],f[h])){j=j||{};j[h]=f[h]}}return j},previous:function(e){if(!e||!this._previousAttributes){return null}return this._previousAttributes[e]},previousAttributes:function(){return x.clone(this._previousAttributes)},_performValidation:function(f,e){var h=this.validate(f);if(h){e.error?e.error(this,h):this.trigger("error",this,h,e);return false}return true}});y.Collection=function(f,e){e||(e={});if(e.comparator){this.comparator=e.comparator;delete e.comparator}this._boundOnModelEvent=x.bind(this._onModelEvent,this);this._reset();f&&this.refresh(f,{silent:true});this.initialize(f,e)};x.extend(y.Collection.prototype,y.Events,{model:y.Model,initialize:function(){},toJSON:function(){return this.map(function(e){return e.toJSON()})},add:function(f,e){if(x.isArray(f)){for(var j=0,h=f.length;j<h;j++){this._add(f[j],e)}}else{this._add(f,e)}return this},remove:function(f,e){if(x.isArray(f)){for(var j=0,h=f.length;j<h;j++){this._remove(f[j],e)}}else{this._remove(f,e)}return this},get:function(e){if(e==null){return null}return this._byId[e.id!=null?e.id:e]},getByCid:function(e){return e&&this._byCid[e.cid||e]},at:function(e){return this.models[e]},sort:function(e){e||(e={});if(!this.comparator){throw Error("Cannot sort a set without a comparator")}this.models=this.sortBy(this.comparator);e.silent||this.trigger("refresh",this,e);return this},pluck:function(e){return x.map(this.models,function(f){return f.get(e)})},refresh:function(f,e){f||(f=[]);e||(e={});this._reset();this.add(f,{silent:true});e.silent||this.trigger("refresh",this,e);return this},fetch:function(f){f||(f={});var e=this,h=v(f.error,e,f);(this.sync||y.sync)("read",this,function(j){e.refresh(e.parse(j));f.success&&f.success(e,j)},h);return this},create:function(f,e){var h=this;e||(e={});if(f instanceof y.Model){f.collection=h}else{f=new this.model(f,{collection:h})}return f.save(null,{success:function(k,j){h.add(k);e.success&&e.success(k,j)},error:e.error})},parse:function(e){return e},chain:function(){return x(this.models).chain()},_reset:function(){this.length=0;this.models=[];this._byId={};this._byCid={}},_add:function(f,e){e||(e={});f instanceof y.Model||(f=new this.model(f,{collection:this}));var h=this.getByCid(f);if(h){throw Error(["Can't add the same model to a set twice",h.id])}this._byId[f.id]=f;this._byCid[f.cid]=f;f.collection=this;this.models.splice(this.comparator?this.sortedIndex(f,this.comparator):this.length,0,f);f.bind("all",this._boundOnModelEvent);this.length++;e.silent||f.trigger("add",f,this,e);return f},_remove:function(f,e){e||(e={});f=this.getByCid(f)||this.get(f);if(!f){return null}delete this._byId[f.id];delete this._byCid[f.cid];delete f.collection;this.models.splice(this.indexOf(f),1);this.length--;e.silent||f.trigger("remove",f,this,e);f.unbind("all",this._boundOnModelEvent);return f},_onModelEvent:function(f,e){if(f==="change:id"){delete this._byId[e.previous("id")];this._byId[e.id]=e}this.trigger.apply(this,arguments)}});x.each(["forEach","each","map","reduce","reduceRight","find","detect","filter","select","reject","every","all","some","any","include","invoke","max","min","sortBy","sortedIndex","toArray","size","first","rest","last","without","indexOf","lastIndexOf","isEmpty"],function(e){y.Collection.prototype[e]=function(){return x[e].apply(x,[this.models].concat(x.toArray(arguments)))}});y.Controller=function(e){e||(e={});if(e.routes){this.routes=e.routes}this._bindRoutes();this.initialize(e)};var d=/:([\w\d]+)/g,c=/\*([\w\d]+)/g;x.extend(y.Controller.prototype,y.Events,{initialize:function(){},route:function(f,e,h){y.history||(y.history=new y.History);x.isRegExp(f)||(f=this._routeToRegExp(f));y.history.route(f,x.bind(function(j){j=this._extractParameters(f,j);h.apply(this,j);this.trigger.apply(this,["route:"+e].concat(j))},this))},saveLocation:function(e){y.history.saveLocation(e)},_bindRoutes:function(){if(this.routes){for(var f in this.routes){var e=this.routes[f];this.route(f,e,this[e])}}},_routeToRegExp:function(e){e=e.replace(d,"([^/]*)").replace(c,"(.*?)");return RegExp("^"+e+"$")},_extractParameters:function(f,e){return f.exec(e).slice(1)}});y.History=function(){this.handlers=[];this.fragment=this.getFragment();x.bindAll(this,"checkUrl")};var t=/^#*/;x.extend(y.History.prototype,{interval:50,getFragment:function(e){return(e||window.location).hash.replace(t,"")},start:function(){var e=document.documentMode;if(e=w.browser.msie&&(!e||e<=7)){this.iframe=w('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow}"onhashchange" in window&&!e?w(window).bind("hashchange",this.checkUrl):setInterval(this.checkUrl,this.interval);return this.loadUrl()},route:function(f,e){this.handlers.push({route:f,callback:e})},checkUrl:function(){var e=this.getFragment();if(e==this.fragment&&this.iframe){e=this.getFragment(this.iframe.location)}if(e==this.fragment||e==decodeURIComponent(this.fragment)){return false}if(this.iframe){window.location.hash=this.iframe.location.hash=e}this.loadUrl()},loadUrl:function(){var e=this.fragment=this.getFragment();return x.any(this.handlers,function(f){if(f.route.test(e)){f.callback(e);return true}})},saveLocation:function(e){e=(e||"").replace(t,"");if(this.fragment!=e){window.location.hash=this.fragment=e;if(this.iframe&&e!=this.getFragment(this.iframe.location)){this.iframe.document.open().close();this.iframe.location.hash=e}}}});y.View=function(e){this._configure(e||{});this._ensureElement();this.delegateEvents();this.initialize(e)};var b=/^(\w+)\s*(.*)$/;x.extend(y.View.prototype,y.Events,{tagName:"div",$:function(e){return w(e,this.el)},initialize:function(){},render:function(){return this},remove:function(){w(this.el).remove();return this},make:function(f,e,h){f=document.createElement(f);e&&w(f).attr(e);h&&w(f).html(h);return f},delegateEvents:function(f){if(f||(f=this.events)){w(this.el).unbind();for(var e in f){var k=f[e],j=e.match(b),h=j[1];j=j[2];k=x.bind(this[k],this);j===""?w(this.el).bind(h,k):w(this.el).delegate(j,h,k)}}},_configure:function(e){if(this.options){e=x.extend({},this.options,e)}if(e.model){this.model=e.model}if(e.collection){this.collection=e.collection}if(e.el){this.el=e.el}if(e.id){this.id=e.id}if(e.className){this.className=e.className}if(e.tagName){this.tagName=e.tagName}this.options=e},_ensureElement:function(){if(!this.el){var e={};if(this.id){e.id=this.id}if(this.className){e["class"]=this.className}this.el=this.make(this.tagName,e)}}});var i=function(f,e){var h=a(this,f,e);h.extend=i;return h};y.Model.extend=y.Collection.extend=y.Controller.extend=y.View.extend=i;var z={create:"POST",update:"PUT","delete":"DELETE",read:"GET"};y.sync=function(f,e,k,j){var h=z[f];f=f==="create"||f==="update"?JSON.stringify(e.toJSON()):null;e={url:u(e),type:h,contentType:"application/json",data:f,dataType:"json",processData:false,success:k,error:j};if(y.emulateJSON){e.contentType="application/x-www-form-urlencoded";e.processData=true;e.data=f?{model:f}:{}}if(y.emulateHTTP){if(h==="PUT"||h==="DELETE"){if(y.emulateJSON){e.data._method=h}e.type="POST";e.beforeSend=function(l){l.setRequestHeader("X-HTTP-Method-Override",h)}}}w.ajax(e)};var g=function(){},a=function(f,e,j){var h;h=e&&e.hasOwnProperty("constructor")?e.constructor:function(){return f.apply(this,arguments)};g.prototype=f.prototype;h.prototype=new g;e&&x.extend(h.prototype,e);j&&x.extend(h,j);h.prototype.constructor=h;h.__super__=f.prototype;return h},u=function(e){if(!(e&&e.url)){throw Error("A 'url' property or function must be specified")}return x.isFunction(e.url)?e.url():e.url},v=function(f,e,h){return function(j){f?f(e,j):e.trigger("error",e,j,h)}}})();(function(){var c,a;var d=Array.prototype.slice,b=function(e,f){return function(){return e.apply(f,arguments)}};_.mixin({parameterize:function(e){return _(e).map(function(g,f){return""+f+"="+(escape(g))}).join("&")},objectify:function(e){return _(e).reduce((function(f,g){if(g[0]!=null){f[g[0]]=g[1]}return f}),{})},val:function(f,e){if(typeof e[f]==="function"){return e[f]()}else{return e[f]}},protocol:function(){if(window.location.protocol.match(/s\:$/)||0){return"https"}else{return"http"}},sanitize:function(e){if(e==null){e=""}return c.trim(e.replace(/['"{}]/g,"").replace(/\s+/g," "))},attr:function(){var f,e;f=arguments[0],e=2<=arguments.length?d.call(arguments,1):[];return _.objectify(_([].concat(f)).zip([].concat(e)))},dequery:function(e){return _.parse(decodeURI(e),"&",/\??(.+)=(.+)/)},debug:function(e){if(e==null){e=true}if(typeof e==="boolean"){e=e?"info":"off"}return typeof localStorage!="undefined"&&localStorage!==null?typeof localStorage.setItem=="function"?localStorage.setItem("debug",e):void 0:void 0},log:function(f,e,g){if(e==null){e="Logger >"}if(g==null){g="info"}if((typeof localStorage!="undefined"&&localStorage!==null?typeof localStorage.getItem=="function"?localStorage.getItem("debug"):void 0:void 0)!==g){return f}if(typeof console!="undefined"&&console!==null){if(typeof console.log=="function"){console.log(e,f)}}return f},tokenize:function(g){var l,h,k,j,f,i,e;if(g==null){g=[]}if(typeof g==="string"){g=g.split(",")}i=_.compact(g);e=[];for(j=0,f=i.length;j<f;j++){k=i[j];l=h=c.trim(k);e.push({id:l,name:h})}return e},parse:function(e,g,f){if(e==null){e=""}return _(e.split(g)).chain().map(function(i){var h;return _(((h=i.match(f))!=null?h:[]).slice(1)).map(function(j){return _.sanitize(j)})}).compact().objectify().value()},follow:function(f,e,g){if(g==null){g="."}if(_.isString(e)){e=e.split(g)}e=_.compact(_.toArray(e));if(!(e&&f)){return}return _(e).reduce(function(h,i){if(_(["object","function"]).include(typeof h)){return _.val(i,h)}},f)}});c=jQuery;c.extend(c.expr[":"],{tko:function(h,g,f,e){return c(h).tko()!=null}});c.fn.extend({tko:function(s,n){var q,u,e,y,j,p,A,f,r,t,z,l,i,g,w,x,v,o,m,k,h;if(s!=null){z=this.data("tko-observing");if(!(z&&s===this.data("tko-datum"))){o=(z!=null?z:z=[]);for(l=0,w=o.length;l<w;l++){f=o[l];f.ignore()}z=[];p=_.toArray(this.find(":tko").not(this.find(".tko-scope *")));if(this.is(":tko")){p.push(this.get(0))}u=(m=s[n])!=null?m:s;e=(k=typeof u.id=="function"?u.id():void 0)!=null?k:u.id;for(i=0,x=p.length;i<x;i++){j=p[i];t=[];h=c(j).tko();for(A in h){q=h[A];t.push(new a.Observer(j,A,q,s,n))}c(j).data("tko-bound-to",u);c(j).data("tko-observers",t);z=z.concat(t)}this.data("tko-bound-to",u).data("tko-id",e);this.data("tko-observing",z);this.data("tko-datum",s)}for(g=0,v=z.length;g<v;g++){r=z[g];r.render()}return z}else{if((y=this.data("tko-bind")||this.data("bind"))==null){return}if(typeof y!=="object"){this.data("tko-bind",(y=_(y).parse(",",/(.+):(.+)/)))}return y}}});a=typeof exports!="undefined"&&exports!==null?exports:this.tko={};a.Observer=(function(){function e(h,o,m,n,f){var l,k,j,i,g;this.el=h;this.key=o;this.binding=m;this.datum=n!=null?n:{};this.base=f;this.conditional=b(this.conditional,this);this.afterRender=b(this.afterRender,this);this.doRender=b(this.doRender,this);this.beforeRender=b(this.beforeRender,this);this.render=b(this.render,this);this.afterEvent=b(this.afterEvent,this);this.doEvent=b(this.doEvent,this);this.beforeEvent=b(this.beforeEvent,this);this.bindEvent=b(this.bindEvent,this);this.data=b(this.data,this);this.ignore=b(this.ignore,this);this.getOriginal=b(this.getOriginal,this);this.stringify=b(this.stringify,this);this.el=c(this.el);this.plusTemplate=_.compact(((l=this.key.match(/^(\+?)(.*?)(\+?)$/))!=null?l:[]).slice(1));this.key=this.key.replace(/\+/g,"");k=this.key.split("@"),this.handler=k[0],this.option=k[1];this.altKey=""+this.handler+"@";this.element=_((j=a.Handlers[this.handler])!=null?j:{}).defaults(a.Handlers["default"]);i=this.binding.split("#"),this.chain=i[0],this.arg=i[1];this.args=_({}).extend((g=this.element.defaults)!=null?g:{},_(this.arg).parse("|",/(.+)\[(.*)\]/));this.chain=_(this.chain.split(".")).compact();if((this.base!=null)&&this.binding[0]!=="."){this.chain.unshift(this.base)}this.event=this.element.events[this.key]||this.element.events[this.altKey];this.getOriginal();this.bindEvent()}e.prototype.stringify=function(f){var i,h,g;i=this.data();if(((g=this.plusTemplate)!=null?g.length:void 0)===1){if(!i){i=this.original}h=[i].join("");if(f){return h}else{return h||void 0}}h=_.map(this.plusTemplate,(function(j){if(j==="+"){return i}else{return this.original}}),this).join("");if(f){return h}else{return h||void 0}};e.prototype.getOriginal=function(){var f,g;if((this.original=(f=this.el.data("tko"))!=null?f.originals[this.key]:void 0)!=null){return}this.original=(g=this.element.get)!=null?g.call(this):void 0;if(this.original!=null){return this.el.data({tko:{originals:_.attr(this.key,this.original)}})}};e.prototype.ignore=function(){return this.el.unbind(this.event,this.proxyEvent)};e.prototype.data=function(l){var f,m,n,j,k,i,h,g;n=this.datum;k=this.chain,f=2<=k.length?d.call(k,0,j=k.length-1):(j=0,[]),m=k[j++];n=_(this.datum).follow(f);if(!_(["object","function"]).include(typeof n)){return}if((i=this.subscription)!=null){if(typeof i.destroy=="function"){i.destroy()}}this.subscription=(h=n[m])!=null?typeof h.subscribe=="function"?h.subscribe(this.render):void 0:void 0;if(typeof n[m]==="function"){return n[m](l)}else{if(l!=null){if(n[m]!=null){return n[m]=l}else{if(typeof n.setter==="function"){return n.setter(_.attr(m,l))}else{return n[m]=l}}}else{return(g=n[m])!=null?g:typeof n.getter=="function"?n.getter(m):void 0}}};e.prototype.bindEvent=function(){if(this.event){return this.el.bind(this.event,this.beforeEvent)}};e.prototype.beforeEvent=function(g,f){return !!(this.element.beforeEvent.call(this,g,f)?this.doEvent(g,f):void 0)};e.prototype.doEvent=function(g,f){return !!((this.element[this.option]||this.element[this.event]).call(this,g,f)?this.afterEvent(g,f):void 0)};e.prototype.afterEvent=function(g,f){return !!this.element.afterEvent.call(this,g,f)};e.prototype.render=function(){return this.beforeRender()};e.prototype.beforeRender=function(){this.element.beforeSet.call(this);return _.defer(this.doRender)};e.prototype.doRender=function(){this.element.set.call(this);return _.defer(this.afterRender)};e.prototype.afterRender=function(){return this.element.afterSet.call(this)};e.prototype.conditional=function(f){if(this.args["if"]!=null){return f===this.args["if"]||f===1*this.args["if"]}else{return f}};return e})();a.Handlers={"default":{defaults:{},events:{},get:function(){},set:function(){},beforeSet:function(){},afterSet:function(){},beforeEvent:function(){return true},afterEvent:function(g,f){if(g!=null){if(!(this.bubble||this.args.bubble)){g.stopPropagation()}if(!(this.allow_default||this.args.allow_default)){g.preventDefault()}return true}else{return !!(this.bubble||this.args.bubble)}}},text:{get:function(){return this.el.text()},set:function(){return this.el.text(this.stringify(true))}},attr:{get:function(){return this.el.attr(this.option)},set:function(){return this.el.attr(this.option,this.stringify(false))}},html:{set:function(){var e;return this.el.html((e=this.data())!=null?e:"")}},prop:{set:function(){return this.el.prop(this.option,this.data())}},data:{set:function(){return this.el.data(this.option,this.data())}},css:{set:function(){var e;return this.el.css(this.option,(e=this.data())!=null?e:"")}},"class":{set:function(){var e;e=this.data();if(this.option){if(this.conditional(e)){return this.el.addClass(this.option)}else{return this.el.removeClass(this.option)}}else{if((e!=null)&&e!==this.current_class){if(this.current_class!=null){this.el.removeClass(this.current_class)}this.el.addClass(e);return this.current_class=e}}}},visible:{defaults:{hide:"hide",show:"show"},set:function(){var i,h,g,e,f;i=this.data();if(this.conditional(i)){return typeof(h=this.el)[e=this.args.show]=="function"?h[e]():void 0}else{return typeof(g=this.el)[f=this.args.hide]=="function"?g[f]():void 0}}},invisible:{defaults:{hide:"hide",show:"show"},set:function(){var i,h,g,e,f;i=this.data();if(this.conditional(i)){return typeof(h=this.el)[e=this.args.hide]=="function"?h[e]():void 0}else{return typeof(g=this.el)[f=this.args.show]=="function"?g[f]():void 0}}},enabled:{set:function(){var e;e=this.data();if(this.conditional(e)){return this.el.prop("disabled",false)}else{return _.defer(b(function(){return this.el.prop("disabled",true)},this))}},afterSet:function(){var e;return typeof(e=this.el).change=="function"?e.change():void 0}},disabled:{set:function(){var e;e=this.data();if(this.conditional(e)){return _.defer(b(function(){return this.el.prop("disabled",true)},this))}else{return this.el.prop("disabled",false)}},afterSet:function(){var e;return typeof(e=this.el).change=="function"?e.change():void 0}},validate:{set:function(){var e,g,f;e=this.data();if((f=this.el.data("tko-validation-widget"))!=null){f.remove()}if(e){g=c("<span class='tko-validation'>"+(_.last(this.chain).replace(/[\_\-]/g," "))+" "+([].concat(e).join(" & "))+"</span>");this.el.data("tko-validation-widget",g);g.insertAfter(this.el);return setTimeout((function(){return g.addClass("visible")}),0)}}},plugin:{set:function(){var g,f,e;g=this.data();if(this.args["default"]&&!(g!=null)){g=this.el.data(this.args["default"])}if(this.args.toggle&&(g=!!g)){g=this.el.data(this.args.toggle)}return typeof(f=this.el)[e=this.option]=="function"?f[e](g):void 0}},click:{defaults:{message:"Are you sure?"},events:{"click@":"click",click:"click"},beforeEvent:function(){var e;this.bubble=false;if(e=this.el.data("confirmation")||this.option==="confirm"){if(typeof e!=="string"){e=this.args.message}return confirm(e)}else{return true}},click:function(){return this.data()||true},toggle:function(){return this.data(!this.data())||true},confirm:function(){return this.data()||true},failover:function(){if(this.el.attr("href")){return this.allow_default=true}else{return this.data()||true}}},value:{events:{value:"change","value@keyup":"keyup"},change:function(){return this.data(this.el.val())},keyup:function(){return this.data(this.el.val())},set:function(){return this.el.val(this.data())}},checked:{events:{checked:"change"},change:function(h,g){var f;if((f=this.el.is(":checked"))!==!!this.data()){return this.data(f)}},set:function(){if(this.data()){return this.el.attr("checked",true)}else{return this.el.removeAttr("checked")}},afterSet:function(){var e;return typeof(e=this.el).change=="function"?e.change():void 0}},partial:{defaults:{index:"position",view:"view"},events:{"partial@sortable":"sortchange sortstop"},afterEvent:function(h,g){var f;if(h.type==="sortstop"){f=this.data();this.args.sorting=false;if(typeof f.ordered=="function"){f.ordered()}}return true},sortable:function(i,h){var f,g;this.args.sorting=true;f={silent:this.args.silent&&i.type!=="sortstop"};return typeof(g=this.data()).reorder=="function"?g.reorder(this.element.order.call(this,h.item),f):void 0},order:function(j){var m,g,l,h,k,f,e;k=j.hasClass("ui-sortable-helper");h=(function(){var p,n,o,i;o=this.el.children();i=[];for(p=0,n=o.length;p<n;p++){m=o[p];m=c(m);if(k){if(m.get(0)===j.get(0)){continue}if(m.hasClass("ui-sortable-placeholder")){m=j}}if(!(l=m.data("tko-id"))){continue}i.push(l)}return i}).call(this);e=[];for(g=0,f=h.length;g<f;g++){l=h[g];e.push(_(["id",this.args.index]).attr(l,g))}return e},get:function(){return this.el.contents().detach()},set:function(){var p,g,n,k,e,o,l,q,m,j,i,h,f;if(this.args.sorting){return}if(this.data()==null){return}this.el.addClass("tko-scope");this.partialsData=[];o=this.args.view;k=false;n=(function(){var t,v,s,u,w,r;u=(typeof(t=this.data()).toArray=="function"?t.toArray():void 0)||[].concat(this.data());r=[];for(v=0,s=u.length;v<s;v++){p=u[v];e=o?(w=typeof p[o]=="function"?p[o]():void 0)!=null?w:p[o]:p;if(!e){continue}this.partialsData.push(e);r.push(e.el)}return r}).call(this);this.oldPartials=(m=_((j=this.partials)!=null?j:this.partials=[])).without.apply(m,n);this.partials=n;if(this.oldPartials){c(this.oldPartials).detach()}if((i=this.original)!=null){if(typeof i.detach=="function"){i.detach()}}if(((h=this.plusTemplate)!=null?h.length:void 0)===1){c(_.isEmpty(this.partials)?this.original:this.partials).appendTo(this.el)}else{f=this.plusTemplate;for(l=0,q=f.length;l<q;l++){g=f[l];c(g==="+"&&this.partials?this.partials:this.original).appendTo(this.el)}}return true},afterSet:function(){var i,h,f,g,e;g=this.partialsData||[];e=[];for(h=0,f=g.length;h<f;h++){i=g[h];e.push(typeof i.refresh=="function"?i.refresh():void 0)}return e}}}}).call(this);(function(){tko.Social={handler:{defaults:{lang:"en",count:"horizontal"},set:function(){var d,i,b,h,g,f,a,e,c;(e=this.option)!=null?e:this.option="twitter";b=tko.Social.networks[this.option];d=this.data();if(typeof d==="string"){d=_.attr(this.args.dataIs||b.dataIs,d)}h=_({}).extend(b.defaults,this.args,d);delete h.dataIs;c=b.config.call(this,h),g=c.title,i=c.height,a=c.width;i=""+i+"px";a=""+a+"px";f=$(this.el.find("> .tko-social."+this.option).get(0)||$('<iframe class="tko-social" allowtransparency="true" frameborder="0" scrolling="no"></iframe>').addClass(this.option));f.attr("title",g);f.css({height:i,width:a});f.attr("src",""+b.remoteUrl+"?"+(_.parameterize(h)));return this.el.append(f)}},networks:{twitter:{config:function(g){var a,b,e,f,c,d;e=tko.Social.networks.twitter.locals;b=e[g.lang]||e.en;f=b.title;d=b[g.count],c=d[0],a=d[1];return{title:f,height:a,width:c}},defaults:{},dataIs:"url",remoteUrl:""+(_.protocol())+"://platform.twitter.com/widgets/tweet_button.html",locals:{en:{title:"Twitter For Websites: Tweet Button",vertical:[55,62],horizontal:[110,20],none:[55,20]}}},facebook:{config:function(g){var a,d,c,f,b,e;f="facebook like button";c=tko.Social.networks.facebook.sizes;d=g.layout==="standard"&&g.show_faces?"faces":g.layout||"standard";e=c[d],b=e[0],a=e[1];b=g.width||b;return{title:f,height:a,width:b}},defaults:{},dataIs:"href",remoteUrl:"http://www.facebook.com/plugins/like.php",sizes:{faces:[450,80],standard:[450,35],button_count:[90,20],box_count:[55,65]}}}};tko.Handlers.social=tko.Social.handler}).call(this);(function(){var a;var b=function(c,d){return function(){return c.apply(d,arguments)}};a=this.tko;a.Observable=(function(){function c(e){var d;this.data=e;this.subscribe=b(this.subscribe,this);this.trigger=b(this.trigger,this);this.set=b(this.set,this);this.get=b(this.get,this);this.accessor=b(this.accessor,this);(d=this._callbacks)!=null?d:this._callbacks=[];this.accessor.debug=this;this.accessor.trigger=this.trigger;this.accessor.subscribe=this.subscribe}c.prototype.accessor=function(d){if(d!=null){return this.set(d)}else{return this.get()}};c.prototype.get=function(){if(typeof this.data==="function"){return this.data.call(this.root)}else{return this.data}};c.prototype.set=function(d){if(!_(d).isEqual(this.current)){if(typeof this.data==="function"){this.data.call(this.root,d)}else{this.data=d}this.current=this.get();this.trigger()}return this.current};c.prototype.trigger=function(){var h,g,e,f,d;f=this._callbacks;d=[];for(g=0,e=f.length;g<e;g++){h=f[g];d.push(h.fire())}return d};c.prototype.subscribe=function(e,d){var f;if(typeof e!=="function"){return}f={fn:e,key:d};f.observable=this;f.fire=function(){return f.fn((this.key?_.attr(this.key,this.observable.get()):this.observable.get()),this.observable)};f.destroy=function(){var g;g=_(this.observable._callbacks).indexOf(this);if(g!==-1){this.observable._callbacks.splice(g,1)}return};this._callbacks.push(f);return f};return c})();a.Observable.ArrayMixin={};a.Observable.ArrayUnderscore=["forEach","each","map","reduce","reduceRight","find","detect","filter","select","reject","every","all","some","any","include","invoke","max","min","sortBy","sortedIndex","toArray","size","first","rest","last","without","indexOf","lastIndexOf","isEmpty","uniq"];_.each(a.Observable.ArrayUnderscore,function(c){return a.Observable.ArrayMixin[c]=function(){var e,d;e=_.clone(this());d=_[c].apply(_,[e].concat(_.toArray(arguments)));this(e);return d}});a.Observable.ArrayMethods=["push","pop","unshift","shift","reverse","sort","splice","concat","slice"];_.each(a.Observable.ArrayMethods,function(c){return a.Observable.ArrayMixin[c]=function(){var e,d;e=_.clone(this());d=Array.prototype[c].apply(e,_.toArray(arguments));this(e);return d}});a.Observable.ArrayMutators=["concat"];_.each(a.Observable.ArrayMutators,function(c){return a.Observable.ArrayMixin[""+c+"_"]=function(){var e,d;e=this();d=Array.prototype[c].apply(e,_.toArray(arguments));this(d);this.trigger();return d}});a.Observable.ArrayWatchers={count:"size"};a.Observable.ArrayMixin.load_watchers=function(){if(this.subscribe==null){return this}_.each(a.Observable.ArrayWatchers,b(function(c,d){this[d]=(new a.Observable(_.val(c,this))).accessor;return this.subscribe(b(function(){return this[d](_.val(c,this))},this))},this));return this};a.Observable.ArrayMixin.add=function(c){if(this.indexOf(c)===-1){this.push(c)}return this()};a.Observable.ArrayMixin.remove=function(g){var f,d,e,g,c;if(typeof g==="function"){c=this.select(g)}c!=null?c:c=[].concat(g);f=_.clone(this());e=(function(){var j,i,h;h=[];for(j=0,i=c.length;j<i;j++){g=c[j];d=_(f).indexOf(g);h.push(d!==-1?f.splice(d,1):void 0)}return h})();this(f);return _(e).chain().flatten().compact().value()};a.observable=function(c){return(new a.Observable(c)).accessor};a.observableArray=function(c){if(c==null){c=[]}return _.extend((new a.Observable(c)).accessor,a.Observable.ArrayMixin).load_watchers()}}).call(this);(function(){var a,c,d,f;var e=Array.prototype.slice,b=function(g,h){return function(){return g.apply(h,arguments)}};a=this.tko;(d=a.Backbone)!=null?d:a.Backbone={};(f=(c=a.Backbone).helpers)!=null?f:c.helpers={};a.Backbone.helpers={iphoneStyle:function(){this.$(":checkbox").iphoneStyle();this.$(".iPhoneCheckLabelOn").width(20);this.$(".iPhoneCheckLabelOff").width(30);return this.$(":checkbox").each(function(){var g;g=$(this).data("iphoneStyle");if(g==null){return}g.optionallyResize("handle");g.optionallyResize("container");return g.initialPosition()})},bind_all:function(){var g;g=1<=arguments.length?e.call(arguments,0):[];return _.bindAll.apply(this,[this].concat(g))},get_attr:function(g,h){if(h==null){h=this}return h.get(g)},set_attr:function(g,i,h){if(h==null){h=this}return h.set(_(g).attr(i))},unset_attr:function(h,g,i){if(g==null){g={}}if(i==null){i=this}return i.unset(h,g)},get_prop:function(g,h){if(h==null){h=this}return h[g]},set_prop:function(g,i,h){if(h==null){h=this}return h[g]=i},unset_prop:function(h,g,i){if(g==null){g={}}if(i==null){i=this}return delete i[h]},notify_of_activity:function(g){return this.activity.subscribe(b(function(h){if(h){return g.childActivityList.add(this)}else{return g.childActivityList.remove(this)}},this))}}}).call(this);(function(){var a,e,f,h;var c=function(i,j){return function(){return i.apply(j,arguments)}},b=Object.prototype.hasOwnProperty,d=function(l,j){for(var i in j){if(b.call(j,i)){l[i]=j[i]}}function k(){this.constructor=l}k.prototype=j.prototype;l.prototype=new k;l.__super__=j.prototype;return l},g=Array.prototype.slice;a=this.tko;(f=a.Backbone)!=null?f:a.Backbone={};(h=(e=a.Backbone).helpers)!=null?h:e.helpers={};a.globalActivity=a.observable(false);a.globalActivityList=a.observableArray([]);a.globalActivityList.subscribe(c(function(i){return a.globalActivity(!_.isEmpty(i))},this));a.Backbone.View=(function(){d(i,Backbone.View);i.prototype.helpers=a.Backbone.helpers;i.prototype.watch={model:["change","error"]};function i(j){if(j==null){j={}}this.stopWatching=c(this.stopWatching,this);this.startWatching=c(this.startWatching,this);this.helper=c(this.helper,this);this.observe=c(this.observe,this);this.refresh=c(this.refresh,this);this.render=c(this.render,this);if(this.bindAll){this.helpers.bind_all.call(this,this.bindAll)}i.__super__.constructor.call(this,j);this.startWatching()}i.prototype.render=function(){$(this.el).append(this.template);return this.observe(this.model,false)};i.prototype.setup=function(){};i.prototype.reload=function(){};i.prototype.refresh=function(j,k){if(k==null){k=true}this.observing=$(this.el).tko(this,"model");if(k){_.defer(this.reload)}return this};i.prototype.observe=function(j,k){if(k==null){k=true}if(!(this.model!=null)||((j!=null)&&j!==this.model)){this.stopWatching();this.model=j;this.startWatching()}return this.refresh(this.model,k)};i.prototype.helper=function(){var j,k,l,m;k=arguments[0],j=2<=arguments.length?g.call(arguments,1):[];return(l=this.helpers)!=null?(m=l[k])!=null?typeof m.apply=="function"?m.apply(this,j):void 0:void 0:void 0};i.prototype.startWatching=function(){var m,k,l,n,j;n=this.watch;j=[];for(l in n){k=n[l];j.push((function(){var r,p,q,s,o;q=[].concat(k);o=[];for(r=0,p=q.length;r<p;r++){m=q[r];o.push((s=_(this).follow(l))!=null?typeof s.bind=="function"?s.bind(m,this.refresh):void 0:void 0)}return o}).call(this))}return j};i.prototype.stopWatching=function(){var m,k,l,n,j;n=this.watch;j=[];for(l in n){k=n[l];j.push((function(){var r,p,q,s,o;q=[].concat(k);o=[];for(r=0,p=q.length;r<p;r++){m=q[r];o.push((s=_(this).follow(l))!=null?typeof s.unbind=="function"?s.unbind(m,this.refresh):void 0:void 0)}return o}).call(this))}return j};return i})();a.Backbone.Model=(function(){d(i,Backbone.Model);i.prototype.helpers=a.Backbone.helpers;i.prototype.globalActivityList=a.globalActivityList;i.prototype.globalActivity=a.globalActivity;i.prototype.bindAll="fetch";i.prototype.views={};function i(k,m){var l,j,n,q,p,o;if(m==null){m={}}this.setter=c(this.setter,this);this.getter=c(this.getter,this);this.buildEmbedded=c(this.buildEmbedded,this);this.bindChildActivity=c(this.bindChildActivity,this);if(this.bindAll){this.helpers.bind_all.call(this,this.bindAll)}(n=this.parent)!=null?n:this.parent=(q=m!=null?m.parent:void 0)!=null?q:m!=null?(p=m.collection)!=null?p.parent:void 0:void 0;this.collection=m!=null?m.collection:void 0;this.activity=a.observable(false);this.activity.subscribe(c(function(r){if(r){return this.globalActivityList.add(this)}else{return this.globalActivityList.remove(this)}},this));this.childActivity=a.observable(false);this.childActivityList=a.observableArray([]);this.childActivityList.subscribe(c(function(r){return this.childActivity(!_.isEmpty(r))},this));this.activitySubscriptions={};this.bindChildActivity({parent:this.parent,collection:this.collection});this.bind("change",this.buildEmbedded);this.buildEmbedded(k,{silent:true});i.__super__.constructor.call(this,k,m);o=this.views;for(l in o){j=o[l];this[l]=new j({model:this})}}i.prototype.bindChildActivity=function(l){var k,n,m,j;if(l==null){l={}}j=[];for(k in l){n=l[k];if((m=this.activitySubscriptions[k])!=null){m.destroy()}j.push(n&&(n.childActivityList!=null)?(n.childActivityList.remove(this),this.activitySubscriptions[k]=this.helpers.notify_of_activity.call(this,n)):void 0)}return j};i.prototype.buildEmbedded=function(s,u){var q,p,n,o,k,t,r,j,m,l;if(s==null){s={}}if(u==null){u={}}if(!(o=typeof this.embed=="function"?this.embed():void 0)){return}if(s instanceof Backbone.Model){k=this.helpers.get_attr;t=this.helpers.unset_attr}else{k=this.helpers.get_prop;t=this.helpers.unset_prop}l=[];for(q in o){p=o[q];n=k.call(s,q);if(typeof n==="undefined"){return}if(this[q]!=null){(m=typeof(r=this[q]).refresh=="function"?r.refresh(n,u):void 0)!=null?m:typeof(j=this[q]).set=="function"?j.set(n,u):void 0}else{this[q]=new p(n,{parent:this})}l.push(t.call(s,q,{silent:true}))}return l};i.prototype.getter=function(j){return this.get(j)};i.prototype.setter=function(k,j){return this.set(k,j)};return i})();a.Backbone.Collection=(function(){d(i,Backbone.Collection);i.prototype.helpers=a.Backbone.helpers;i.prototype.globalActivityList=a.globalActivityList;i.prototype.globalActivity=a.globalActivity;i.prototype.bindAll="fetch";"refresh";function i(k,j){if(j==null){j={}}this.save=c(this.save,this);this.ordered=c(this.ordered,this);this.reorder=c(this.reorder,this);if(this.bindAll){this.helpers.bind_all.call(this,this.bindAll)}this.parent=j!=null?j.parent:void 0;this.activity=a.observable(false);this.activity.subscribe(c(function(l){if(l){return this.globalActivityList.add(this)}else{return this.globalActivityList.remove(this)}},this));this.childActivity=a.observable(false);this.childActivityList=a.observableArray([]);this.childActivityList.subscribe(c(function(l){return this.childActivity(!_.isEmpty(l))},this));i.__super__.constructor.call(this,k,j)}i.prototype.reorder=function(o,l){var k,n,j,m;for(n=0,j=o.length;n<j;n++){k=o[n];if((m=this.get(k))!=null){m.set(k,l)}}return this.sort(l)};i.prototype.ordered=function(){return this.trigger("ordered",this)};i.prototype.save=function(){return this.invoke("save")};return i})();a.Backbone.NoticeView=(function(){function i(){this.render=c(this.render,this);this.clearTimer=c(this.clearTimer,this);this.setTimer=c(this.setTimer,this);this.hide=c(this.hide,this);this.initialize=c(this.initialize,this);i.__super__.constructor.apply(this,arguments)}d(i,Backbone.View);i.prototype.className="success";i.prototype.defaultMessage="";i.prototype.displayContainer="#tko-notices";i.prototype.displayLength=5000;i.prototype.showEffect=[400];i.prototype.hideEffect=[400,function(){return $(this).remove()}];i.prototype.initialize=function(j){return this.render(j)};i.prototype.hide=function(){var j;return(j=$(this.el)).slideUp.apply(j,this.hideEffect)};i.prototype.setTimer=function(){return this.timer=setTimeout(this.hide,this.displayLength)};i.prototype.clearTimer=function(){return clearTimeout(this.timer)};i.prototype.render=function(k){var j,l;if(k==null){k=this.defaultMessage}j=(l=$(this.el).html(k).hide().appendTo($(this.displayContainer))).slideDown.apply(l,this.showEffect);this.setTimer();j.hover(this.clearTimer,this.setTimer);return this};return i})();a.Backbone.ErrorView=(function(){function i(){i.__super__.constructor.apply(this,arguments)}d(i,a.Backbone.NoticeView);i.prototype.className="error";i.prototype.defaultMessage="Uh oh! Something went wrong. Please try again.";return i})()}).call(this);(function(){var a;a=this.tko;a.Backbone.LocalCache=function(b,d){var c;if(typeof localStorage=="undefined"||localStorage===null){return false}if(b==null){return true}if(d!=null){return(c=localStorage.setItem(b,JSON.stringify(d)))!=null?c:d}else{d=localStorage.getItem(b);if(d!=null){return JSON.parse(d)}}};a.Backbone.CacheSync=function(b,i,n,k){var c,j,p,f,o,m,e,l,d,h,g;l=a.Backbone.LocalCache;if(l()){e={success:n,error:k};o=location.host;if(j=i.collection){f=(h=typeof j.url=="function"?j.url():void 0)!=null?h:j.url;p=o+f;if(b!=="read"){l(p,false)}}d=(g=typeof i.url=="function"?i.url():void 0)!=null?g:i.url;m=o+d;switch(b){case"read":c=l(m);if((e.success!=null)&&(c!=null)){e.success(c,"cache")}n=function(r,q){l(m,r);if(e.success!=null){return e.success(r,q)}}}}return Backbone.sync(b,i,n,k)};a.Backbone.NotifySync=function(g,e,f,d){var c,b;b={success:f,error:d};e.activity(true);if(!(c=e._name)){f=function(i,h){e.activity(false);return b.success(i,h)}}else{switch(g){case"create":new a.Backbone.NoticeView("Creating "+c+" ...");f=function(i,h){new a.Backbone.NoticeView(""+c+" Successfully Created");e.activity(false);return b.success(i,h)};break;case"read":new a.Backbone.NoticeView("Loading "+c+" ...");f=function(i,h){if(h!=="cache"){new a.Backbone.NoticeView(""+c+" Successfully Loaded");e.activity(false)}return b.success(i,h)};break;case"update":new a.Backbone.NoticeView("Updating "+c+" ...");f=function(i,h){new a.Backbone.NoticeView(""+c+" Successfully Updated");e.activity(false);return b.success(i,h)};break;case"delete":new a.Backbone.NoticeView("Deleting "+c+" ...");f=function(i,h){new a.Backbone.NoticeView(""+c+" Successfully Deleted");e.activity(false);return b.success(i,h)}}}d=function(i,h){new a.Backbone.ErrorView("Something went wrong!!");e.activity(false);return b.error(i,h)};return a.Backbone.CacheSync(g,e,f,d)}}).call(this);(function(){var a;a=window.GeoHash={BITS:[16,8,4,2,1],BASE32:"0123456789bcdefghjkmnpqrstuvwxyz",NEIGHBORS:{right:{even:"bc01fg45238967deuvhjyznpkmstqrwx",odd:"p0r21436x8zb9dcf5h7kjnmqesgutwvy"},left:{even:"238967debc01fg45kmstqrwxuvhjyznp",odd:"14365h7k9dcfesgujnmqp0r2twvyx8zb"},top:{even:"p0r21436x8zb9dcf5h7kjnmqesgutwvy",odd:"bc01fg45238967deuvhjyznpkmstqrwx"},bottom:{even:"14365h7k9dcfesgujnmqp0r2twvyx8zb",odd:"238967debc01fg45kmstqrwxuvhjyznp"}},BORDERS:{right:{even:"bcfguvyz",odd:"prxz"},left:{even:"0145hjnp",odd:"028b"},top:{even:"prxz",odd:"bcfguvyz"},bottom:{even:"028b",odd:"0145hjnp"}},DISTANCE:{miles:3961,kilometers:6373},decode:function(j){var k,f,e,d,m,h,g,l,b,i;d=[[-90,90],[-180,180]];e=1;for(h=0,l=j.length;h<l;h++){k=j[h];f=_(this.BASE32).indexOf(k);i=this.BITS;for(g=0,b=i.length;g<b;g++){m=i[g];d[e][f&m?0:1]=(d[e][0]+d[e][1])/2;e^=1}}return _.zip.apply(this,d)},encode:function(j,b,g){var k,i,d,h,f,e,l,m;if(g==null){g=12}e=[j,b];m=[[-90,90],[-180,180]];f=1;h=(function(){var n,c;c=[];for(i=0,n=g-1;(0<=n?i<=n:i>=n);(0<=n?i+=1:i-=1)){d=0;for(k=0;k<=4;k++){l=(m[f][0]+m[f][1])/2;m[f][e[f]>l?0:1]=l;if(e[f]>l){d|=this.BITS[k]}f^=1}c.push(this.BASE32[d])}return c}).call(this);return h.join("")},neighbors:function(d){var e,b,c;c=(function(){var i,g,h,f;h=[["top","right"],["right","bottom"],["bottom","left"],["left","top"]];f=[];for(i=0,g=h.length;i<g;i++){e=h[i];b=this.adjacent(d,e[0]);f.push([b,this.adjacent(b,e[1])])}return f}).call(this);return _.flatten(c)},adjacent:function(g,c){var f,b,d,e;e=[g.slice(0,-1),g[g.length-1]],f=e[0],b=e[1];d=(g.length%2)===1?"odd":"even";if(_(this.BORDERS[c][d]).include(b)){f=this.adjacent(f,c)}return f+this.BASE32[_(this.NEIGHBORS[c][d]).indexOf(b)]},radians:function(b){return b/57.2957795},distance:function(l,m,n){var e,k,g,f,h,d,b,j,i;if(n==null){n="miles"}e=this.DISTANCE[n];d=l[0],j=l[1];b=m[0],i=m[1];f=this.radians(b-d);h=this.radians(i-j);k=Math.sin(f/2)*Math.sin(f/2)+Math.cos(this.radians(d))*Math.cos(this.radians(b))*Math.sin(h/2)*Math.sin(h/2);g=2*Math.atan2(Math.sqrt(k),Math.sqrt(1-k));return e*g},in_bounds:function(i,l,m){var j,p,o,h,e,g,r,b,q,t,f,n,s,k,d,c;if(l==null){l=2}k=[i.getSouthWest(),i.getNorthEast()],n=k[0],g=k[1];d=[[g.lat(),n.lng()],[g.lat(),g.lng()],[n.lat(),g.lng()],[n.lat(),n.lng()]],r=d[0],g=d[1],t=d[2],n=d[3];p=(c=(function(){var x,v,w,u;w=[r,g,t,n];u=[];for(x=0,v=w.length;x<v;x++){j=w[x];u.push(this.encode(j[0],j[1],l))}return u}).call(this),r=c[0],g=c[1],t=c[2],n=c[3],c);o=r;e=(function(){var u;u=[];while(o!==n){u.push(o=this.adjacent(o,"bottom"))}return u}).call(this);e.push(r);o=g;q=(function(){var u;u=[];while(o!==t){u.push(o=this.adjacent(o,"bottom"))}return u}).call(this);q.push(r);b=[].concat(e).concat(q);for(h=0,s=e.length;h<s;h++){f=e[h];b.push(o=f);while(o!==q[h]){b.push(o);o=this.adjacent(o,"right")}}if(m){return _.intersect(b,m)}else{return _.uniq(b)}},bounds_for:function(f){var g,h,c,b,d;d=_.flatten(this.decode(f)),h=d[0],b=d[1],c=d[2],g=d[3];return new google.maps.LatLngBounds(new google.maps.LatLng(c,b),new google.maps.LatLng(h,g))},map_regions:function(g){var d,f,e,c,b;d=100;b=[];for(e=0,c=g.length;e<c;e++){f=g[e];d=d+10;b.push(new google.maps.Rectangle({map:Search.Map.canvas,bounds:this.bounds_for(f),fillColor:d.toString(16)}))}return b}}}).call(this);(function(){window.Vertebrae={load:function(){}}}).call(this);(function(){var b=function(d,e){return function(){return d.apply(e,arguments)}},a=Object.prototype.hasOwnProperty,c=function(g,e){for(var d in e){if(a.call(e,d)){g[d]=e[d]}}function f(){this.constructor=g}f.prototype=e.prototype;g.prototype=new f;g.__super__=e.prototype;return g};Vertebrae.PhotoModel=(function(){function d(){this.autoSave=b(this.autoSave,this);this.toJSON=b(this.toJSON,this);d.__super__.constructor.apply(this,arguments)}c(d,tko.Backbone.Model);d.prototype.sync=tko.Backbone.NotifySync;d.prototype.initialize=function(e){return this.bind("change:caption",this.autoSave)};d.prototype.toJSON=function(){return{photo:this.attributes}};d.prototype.autoSave=function(e){return e.save()};return d})()}).call(this);(function(){var b=function(d,e){return function(){return d.apply(e,arguments)}},a=Object.prototype.hasOwnProperty,c=function(g,e){for(var d in e){if(a.call(e,d)){g[d]=e[d]}}function f(){this.constructor=g}f.prototype=e.prototype;g.prototype=new f;g.__super__=e.prototype;return g};Vertebrae.PropertyModel=(function(){function d(){this.embed=b(this.embed,this);d.__super__.constructor.apply(this,arguments)}c(d,tko.Backbone.Model);d.prototype.sync=tko.Backbone.NotifySync;d.prototype.toJSON=function(){return{property:_.clone(this.attributes)}};d.prototype.embed=function(){return{photos:Vertebrae.PhotoCollection,reservations:Vertebrae.ReservationCollection}};return d})()}).call(this);(function(){var b=function(d,e){return function(){return d.apply(e,arguments)}},a=Object.prototype.hasOwnProperty,c=function(g,e){for(var d in e){if(a.call(e,d)){g[d]=e[d]}}function f(){this.constructor=g}f.prototype=e.prototype;g.prototype=new f;g.__super__=e.prototype;return g};Vertebrae.ReservationModel=(function(){function d(){this.departure_date=b(this.departure_date,this);this.arrival_date=b(this.arrival_date,this);this.date_for=b(this.date_for,this);this.fullCalendar=b(this.fullCalendar,this);this.validate=b(this.validate,this);this.toJSON=b(this.toJSON,this);d.__super__.constructor.apply(this,arguments)}c(d,tko.Backbone.Model);d.prototype.sync=tko.Backbone.NotifySync;d.prototype.defaults={check_in:(new Date()).format("MM/dd/yyyy"),check_out:(new Date((new Date()).getTime()+86400000)).format("MM/dd/yyyy")};d.prototype.toJSON=function(){return{reservation:_.clone(this.attributes)}};d.prototype.validate=function(e){if(!_(this.errors=e.errors).isEmpty()){return this.errors}};d.prototype.fullCalendar=function(){return{title:this.get("state"),start:this.get("start_date"),end:this.get("end_date"),className:this.get("state")}};d.prototype.date_for=function(e,g){var f;if(e==null){return}if(g!=null){return this.set(_.attr(e,g))}else{return(f=Date.parseString(this.get(e)))!=null?f.format("NNN d, y"):void 0}};d.prototype.arrival_date=function(e){return this.date_for("check_in",e)};d.prototype.departure_date=function(e){return this.date_for("check_out",e)};return d})()}).call(this);(function(){var a=Object.prototype.hasOwnProperty,b=function(f,d){for(var c in d){if(a.call(d,c)){f[c]=d[c]}}function e(){this.constructor=f}e.prototype=d.prototype;f.prototype=new e;f.__super__=d.prototype;return f};Vertebrae.UserModel=(function(){function c(){c.__super__.constructor.apply(this,arguments)}b(c,tko.Backbone.Model);c.prototype.url=function(){return"/settings/user"};c.prototype.toJSON=function(){return{user:_.clone(this.attributes)}};c.prototype.initialize=function(d){};return c})()}).call(this);(function(){var b=function(d,e){return function(){return d.apply(e,arguments)}},a=Object.prototype.hasOwnProperty,c=function(g,e){for(var d in e){if(a.call(e,d)){g[d]=e[d]}}function f(){this.constructor=g}f.prototype=e.prototype;g.prototype=new f;g.__super__=e.prototype;return g};Vertebrae.PhotoCollection=(function(){function d(){this.count=b(this.count,this);this.countable=b(this.countable,this);this.comparator=b(this.comparator,this);this.url=b(this.url,this);d.__super__.constructor.apply(this,arguments)}c(d,tko.Backbone.Collection);d.prototype.model=Vertebrae.PhotoModel;d.prototype.url=function(){return""+(this.parent.url())+"/photos"};d.prototype.comparator=function(e){return e.get("position")};d.prototype.countable=function(){return this.filter(function(e){return !e.get("placeholder")})};d.prototype.count=function(){return this.countable().length};return d})()}).call(this);(function(){var a=Object.prototype.hasOwnProperty,b=function(f,d){for(var c in d){if(a.call(d,c)){f[c]=d[c]}}function e(){this.constructor=f}e.prototype=d.prototype;f.prototype=new e;f.__super__=d.prototype;return f};Vertebrae.PropertyCollection=(function(){function c(){c.__super__.constructor.apply(this,arguments)}b(c,tko.Backbone.Collection);c.prototype.sync=tko.Backbone.NotifySync;c.prototype.model=Vertebrae.PropertyModel;c.prototype.url=function(){return"/properties"};return c})()}).call(this);(function(){var b=function(d,e){return function(){return d.apply(e,arguments)}},a=Object.prototype.hasOwnProperty,c=function(g,e){for(var d in e){if(a.call(e,d)){g[d]=e[d]}}function f(){this.constructor=g}f.prototype=e.prototype;g.prototype=new f;g.__super__=e.prototype;return g};Vertebrae.ReservationCollection=(function(){function d(){this.unavailable=b(this.unavailable,this);this.fullCalendar=b(this.fullCalendar,this);this.comparator=b(this.comparator,this);this.url=b(this.url,this);d.__super__.constructor.apply(this,arguments)}c(d,tko.Backbone.Collection);d.prototype.model=Vertebrae.ReservationModel;d.prototype.sync=tko.Backbone.NotifySync;d.prototype.unavailable_states=["accepted","paid","settled"];d.prototype.url=function(){return""+(this.parent.url())+"/reservations"};d.prototype.comparator=function(e){return new Date(e.get("check_in"))};d.prototype.fullCalendar=function(f,e){return _(this.unavailable()).map(function(g){return g.fullCalendar()})};d.prototype.unavailable=function(){return this.filter(b(function(e){return _(this.unavailable_states).include(e.get("state"))},this))};return d})()}).call(this);