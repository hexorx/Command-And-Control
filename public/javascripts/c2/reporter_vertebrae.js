(function(){window.Reporter={init:function(a){$(document).ajaxSend(function(d,f,b){var c;c=$("meta[name='csrf-token']").attr("content");return f.setRequestHeader("X-CSRF-Token",c)});if(!window.location.hash){window.location.hash="/"}window.location.hash=unescape(window.location.hash);this.App=new Reporter.AppController(a);this.App.tko();Backbone.history.start();$(".dropdown-trigger").bind("click",function(){return $(this).parent().toggleClass("active")});return $("#summation").click(function(){var b;if((b=Reporter.App.bucket)!=null){b.toggle()}return false})}}}).call(this);(function(){var b=function(d,e){return function(){return d.apply(e,arguments)}},a=Object.prototype.hasOwnProperty,c=function(g,e){for(var d in e){if(a.call(e,d)){g[d]=e[d]}}function f(){this.constructor=g}f.prototype=e.prototype;g.prototype=new f;g.__super__=e.prototype;return g};Reporter.LocusMenuView=(function(){function d(){this.render=b(this.render,this);this.initialize=b(this.initialize,this);d.__super__.constructor.apply(this,arguments)}c(d,tko.Backbone.View);d.prototype.tagName="ul";d.prototype.template=JST["locus/menu"];d.prototype.initialize=function(){return this.render().setup()};d.prototype.render=function(){$(this.el).append(this.template(this.model));return this.observe(this.model,false)};return d})()}).call(this);(function(){var b=function(d,e){return function(){return d.apply(e,arguments)}},a=Object.prototype.hasOwnProperty,c=function(g,e){for(var d in e){if(a.call(e,d)){g[d]=e[d]}}function f(){this.constructor=g}f.prototype=e.prototype;g.prototype=new f;g.__super__=e.prototype;return g};Reporter.BucketModel=(function(){function d(){this.redraw=b(this.redraw,this);this.toggle=b(this.toggle,this);this.embed=b(this.embed,this);d.__super__.constructor.apply(this,arguments)}c(d,tko.Backbone.Model);d.prototype.sync=tko.Backbone.NotifySync;d.prototype.embed=function(){return{series:Reporter.SeriesCollection}};d.prototype.initialize=function(){return this.cumulative=false};d.prototype.toggle=function(){this.cumulative=!this.cumulative;return this.redraw()};d.prototype.redraw=function(e){if(e==null){e=this.chart}if(e!=null){e.destroy()}this.chart=new Highcharts.Chart({chart:{renderTo:"chart",zoomType:"x"},title:{text:""+(this.cumulative?"Cumulative ":"")+(this.get("label"))+" "+(this.parent.get("label"))},xAxis:{type:"datetime",tickInterval:7*24*3600*1000,tickWidth:0,gridLineWidth:1,labels:{align:"left",x:3,y:-3}},yAxis:{title:{text:"Awesomeness"}},series:this.series.data(this.cumulative)});return _.defer(function(){var f;if((f=Reporter.App.bucket)!=null?f.cumulative:void 0){return $("#summation").addClass("active")}else{return $("#summation").removeClass("active")}})};return d})()}).call(this);(function(){var b=function(d,e){return function(){return d.apply(e,arguments)}},a=Object.prototype.hasOwnProperty,c=function(g,e){for(var d in e){if(a.call(e,d)){g[d]=e[d]}}function f(){this.constructor=g}f.prototype=e.prototype;g.prototype=new f;g.__super__=e.prototype;return g};Reporter.LocusModel=(function(){function d(){this.embed=b(this.embed,this);d.__super__.constructor.apply(this,arguments)}c(d,tko.Backbone.Model);d.prototype.sync=tko.Backbone.NotifySync;d.prototype.views={menu:Reporter.LocusMenuView};d.prototype.embed=function(){return{buckets:Reporter.BucketCollection}};return d})()}).call(this);(function(){var b=function(d,e){return function(){return d.apply(e,arguments)}},a=Object.prototype.hasOwnProperty,c=function(g,e){for(var d in e){if(a.call(e,d)){g[d]=e[d]}}function f(){this.constructor=g}f.prototype=e.prototype;g.prototype=new f;g.__super__=e.prototype;return g};Reporter.SeriesModel=(function(){function d(){this.cumulative_attrs=b(this.cumulative_attrs,this);this.attrs=b(this.attrs,this);d.__super__.constructor.apply(this,arguments)}c(d,tko.Backbone.Model);d.prototype.sync=tko.Backbone.NotifySync;d.prototype.defaults={name:"ShortTermHousing",pointInterval:24*3600*1000,pointStart:Date.UTC(2011,0,1)};d.prototype.attrs=function(){return this.attributes};d.prototype.cumulative_attrs=function(){var e;e=0;return _.defaults({data:_.map(this.get("data"),b(function(f){return e+=f},this))},this.attributes)};return d})()}).call(this);(function(){var b=function(d,e){return function(){return d.apply(e,arguments)}},a=Object.prototype.hasOwnProperty,c=function(g,e){for(var d in e){if(a.call(e,d)){g[d]=e[d]}}function f(){this.constructor=g}f.prototype=e.prototype;g.prototype=new f;g.__super__=e.prototype;return g};Reporter.BucketCollection=(function(){function d(){this.url=b(this.url,this);d.__super__.constructor.apply(this,arguments)}c(d,tko.Backbone.Collection);d.prototype.sync=tko.Backbone.NotifySync;d.prototype.model=Reporter.BucketModel;d.prototype.url=function(){return""+(this.parent.url())+"/buckets"};return d})()}).call(this);(function(){var a=Object.prototype.hasOwnProperty,b=function(f,d){for(var c in d){if(a.call(d,c)){f[c]=d[c]}}function e(){this.constructor=f}e.prototype=d.prototype;f.prototype=new e;f.__super__=d.prototype;return f};Reporter.LocusCollection=(function(){function c(){c.__super__.constructor.apply(this,arguments)}b(c,tko.Backbone.Collection);c.prototype.sync=tko.Backbone.NotifySync;c.prototype.model=Reporter.LocusModel;c.prototype.url=function(){return"/c2/reporter/locus"};return c})()}).call(this);(function(){var b=function(d,e){return function(){return d.apply(e,arguments)}},a=Object.prototype.hasOwnProperty,c=function(g,e){for(var d in e){if(a.call(e,d)){g[d]=e[d]}}function f(){this.constructor=g}f.prototype=e.prototype;g.prototype=new f;g.__super__=e.prototype;return g};Reporter.SeriesCollection=(function(){function d(){this.data=b(this.data,this);this.url=b(this.url,this);d.__super__.constructor.apply(this,arguments)}c(d,tko.Backbone.Collection);d.prototype.sync=tko.Backbone.NotifySync;d.prototype.model=Reporter.SeriesModel;d.prototype.url=function(){return""+(this.parent.url())+"/series"};d.prototype.data=function(e){if(e==null){e=false}if(e){return this.invoke("cumulative_attrs")}else{return this.invoke("attrs")}};return d})()}).call(this);(function(){var b=function(d,e){return function(){return d.apply(e,arguments)}},a=Object.prototype.hasOwnProperty,c=function(g,e){for(var d in e){if(a.call(e,d)){g[d]=e[d]}}function f(){this.constructor=g}f.prototype=e.prototype;g.prototype=new f;g.__super__=e.prototype;return g};Reporter.AppController=(function(){function d(){this.bucket=b(this.bucket,this);this.locus=b(this.locus,this);this.root=b(this.root,this);this.tko=b(this.tko,this);d.__super__.constructor.apply(this,arguments)}c(d,Backbone.Controller);d.prototype.namespace="c2-reporter";d.prototype.page="#/account";d.prototype.routes={"/":"root","/locus/:locus":"locus","/locus/:locus/:bucket":"bucket"};d.prototype.initialize=function(e){if(e.loci!=null){this.loci=new Reporter.LocusCollection(e.loci)}return this};d.prototype.tko=function(){return $("#sidebar").tko(Reporter,"App")};d.prototype.root=function(){};d.prototype.locus=function(e){return console.log("Locus >",e)};d.prototype.bucket=function(e,f){this.locus=this.loci.get(e);this.bucket=this.locus.buckets.get(f);return this.bucket.redraw()};return d})()}).call(this);