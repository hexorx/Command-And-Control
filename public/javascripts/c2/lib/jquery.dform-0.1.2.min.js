(function(a){function h(b,d,f){if(typeof d=="string"){a.isArray(b[d])||(b[d]=[]);b[d].push(f)}else typeof d=="object"&&a.each(d,function(g,i){h(b,g,i)})}var c={},e={};a.fn.extend({runSubscription:function(b,d,f){var g=this;a.dform.hasSubscription(b)&&a.each(c[b],function(i,j){j.call(g,d,f)});return this},runAll:function(b){var d=b.type,f=this;this.runSubscription("[pre]",b,d);a.each(b,function(g,i){a(f).runSubscription(g,i,d)});this.runSubscription("[post]",b,d);return this},formElement:function(b){var d=
a.dform.createElement(b);this.append(a(d));a(d).runAll(b);return this},buildForm:function(b){if(typeof b=="string"){var d=a(this);a.get(b,function(g){a(d).buildForm(g)},a.dform.options.ajaxFormat)}else if(b.type)this.formElement(b);else{var f=this.is("form")?this:this.append("<form>").children("form:last");b=a.extend({type:"form"},b);a(f).dformAttr(b);a(f).runAll(b)}},dformAttr:function(b,d){var f=a.keyset(c);a.isArray(d)&&a.merge(f,d);this.attr(a.withoutKeys(b,f));return this}});a.extend(a,{keyset:function(b){var d=
[];a.each(b,function(f){d.push(f)});return d},withKeys:function(b,d){var f={};a.each(d,function(g,i){if(b[i])f[i]=b[i]});return f},withoutKeys:function(b,d){var f={};a.each(b,function(g,i){if(a.inArray(g,d)==-1)f[g]=i});return f}});a.dform={options:{prefix:"ui-dform-",ajaxFormat:"json",defaultType:function(b){return a("<"+b.type+">").dformAttr(b)}},removeType:function(b){delete e[b]},typeNames:function(){return a.keyset(e)},addType:function(b,d){h(e,b,d)},addTypeIf:function(b,d,f){b&&a.dform.addType(d,
f)},subscriberNames:function(){return a.keyset(c)},subscribe:function(b,d){h(c,b,d)},subscribeIf:function(b,d,f){b&&a.dform.subscribe(d,f)},removeSubscription:function(b){delete c[b]},hasSubscription:function(b){return c[b]?true:false},createElement:function(b){var d=b.type;if(!d)throw"No element type given! Must always exist.";var f=null;if(e[d]){var g=a.withoutKeys(b,"type");a.each(e[d],function(i,j){f=j.call(f,g)})}else f=a.dform.options.defaultType(b);return a(f)}}})(jQuery);
(function(a){a.fn.placeholder=function(h){var c=this;a(this).data("placeholder",h);a(this).val(h);a(this).focus(function(){a(this).val()==a(this).data("placeholder")&&a(this).val("")});a(this).blur(function(){a(this).val()==""&&a(this).val(a(this).data("placeholder"))});a(this).parents("form").submit(function(){a(c).val()==a(c).data("placeholder")&&a(c).val("")});return this}})(jQuery);
(function(a){function h(c,e){return function(b){var d=a(c).dformAttr(b,e);if(a(d).is("input")||a(d).is("button"))a(d).attr("type",b.type);return d}}a.dform.addType({text:h("<input>"),password:h("<input>"),submit:h("<input>"),reset:h("<input>"),hidden:h("<input>"),radio:h("<input>"),checkbox:h("<input>"),checkboxes:h("<div>",["name"]),radiobuttons:h("<div>",["name"]),container:h("<div>"),file:h("<input>")});a.dform.subscribe({"class":function(c){this.addClass(c)},html:function(c){this.html(c)},elements:function(c){var e=
a(this);a.each(c,function(b,d){if(typeof b=="string")d.name=name;a(e).formElement(d)})},value:function(c){this.val(c)},options:function(c,e){var b=a(this);if(e=="select")a.each(c,function(d,f){var g;if(typeof f=="string")g=a("<option>").attr("value",d).html(f);if(typeof f=="object")g=h("<option>",{})(a.withoutKeys(f,["value"])).html(f.value);a(b).append(g)});else if(e=="checkboxes"||e=="radiobuttons"){b=this;a.each(c,function(d,f){var g=e=="radiobuttons"?{type:"radio"}:{type:"checkbox"};if(typeof f==
"string")g.caption=f;else a.extend(g,f);g.value=d;a(b).formElement(g)})}},caption:function(c,e){if(e=="fieldset")this.prepend(a("<legend>").html(c));else{var b={type:"label"};if(typeof c=="string")b.html=c;else a.extend(b,c);if(this.attr("id"))b["for"]=this.attr("id");var d=a.dform.createElement(b);e=="checkbox"||e=="radio"?this.parent().append(a(d)):a(d).insertBefore(a(this));a(d).runAll(b)}},type:function(c,e){a.dform.options.prefix&&this.addClass(a.dform.options.prefix+e)},"[post]":function(c,
e){if(e=="checkboxes"||e=="radiobuttons")this.children("[type="+(e=="checkboxes"?"checkbox":"radio")+"]").each(function(){a(this).attr("name",c.name)})}})})(jQuery);
(function(a){function h(c,e){var b=a.keyset(a.ui[c].prototype.options);return a.withKeys(e,b)}a.dform.subscribeIf(a.isFunction(a.fn.placeholder),"placeholder",function(c,e){if(e=="text"||e=="textarea")a(this).placeholder(c)});a.dform.addTypeIf(a.isFunction(a.fn.progressbar),"progressbar",function(c){return a("<div>").dformAttr(c).progressbar(h("progressbar",c))});a.dform.addTypeIf(a.isFunction(a.fn.slider),"slider",function(c){return a("<div>").dformAttr(c).slider(h("slider",c))});a.dform.addTypeIf(a.isFunction(a.fn.accordion),
"accordion",function(c){return a("<div>").dformAttr(c)});a.dform.addTypeIf(a.isFunction(a.fn.tabs),"tabs",function(c){return a("<div>").dformAttr(c)});a.dform.subscribeIf(a.isFunction(a.fn.accordion),"entries",function(c,e){var b=this;e=="accordion"&&a.each(c,function(d,f){a.extend(f,{type:"container"});a(b).formElement(f);a(b).children("div:last").prev().wrapInner(a("<a>").attr("href","#"))})});a.dform.subscribeIf(a.isFunction(a.fn.tabs),"entries",function(c,e){var b=this;if(e=="tabs"){this.append("<ul>");
var d=a(b).children("ul:first");a.each(c,function(f,g){var i=g.id?g.id:f;a.extend(g,{type:"container",id:i});a(b).formElement(g);var j=a(b).children("div:last").prev();a(j).wrapInner(a("<a>").attr("href","#"+i));a(d).append(a("<li>").wrapInner(j))})}});a.dform.subscribeIf(a.isFunction(a.fn.dialog),"dialog",function(c,e){if(e=="form"||e=="fieldset")this.dialog(c)});a.dform.subscribeIf(a.isFunction(a.fn.resizable),"resizable",function(c){this.resizable(c)});a.dform.subscribeIf(a.isFunction(a.fn.datepicker),
"datepicker",function(c,e){e=="text"&&this.datepicker(c)});a.dform.subscribeIf(a.isFunction(a.fn.autocomplete),"autocomplete",function(c,e){e=="text"&&this.autocomplete(c)});a.dform.subscribe("[post]",function(c,e){if(this.parents("form").hasClass("ui-widget")){if((e=="button"||e=="submit")&&a.isFunction(a.fn.button))this.button();a.inArray(e,["text","textarea","password","fieldset"])!=-1&&this.addClass("ui-widget-content ui-corner-all")}if(e=="accordion"){var b=h(e,c);a.extend(b,{header:"label"});
this.accordion(b)}else if(e=="tabs"){b=h(e,c);this.tabs(b)}});a.dform.subscribeIf(a.isFunction(a.fn.validate),{"[pre]":function(c,e){if(e=="form"){var b={};if(this.hasClass("ui-widget"))b={highlight:function(d){a(d).addClass("ui-state-highlight")},unhighlight:function(d){a(d).removeClass("ui-state-highlight")}};this.validate(b)}},validate:function(c){this.rules("add",c)}});a.dform.subscribeIf(a.isFunction(a.fn.ajaxForm),"ajax",function(c,e){e=="form"&&this.ajaxForm(c)});a.dform.subscribeIf(a.isFunction(a.fn.wysiwyg),
"wysiwyg",function(){})})(jQuery);
